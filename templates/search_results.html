<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Search Results - BloodBridge</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <header><h1><a href="/home">BloodBridge: Connecting Donors & Recipients</a></h1></header>
    <nav><div class="container"><ul><li>Welcome, {{ session.name }}!</li></ul></div></nav>
    <div class="container content">
        <h2>Search Results for: {{ blood_group_needed }} in {{ city }}, {{ state }}</h2>

        {% if city_matches %}
            <h3><span style="color: #2b6cb0;">Exact Matches ({{ city }}, {{ state }})</span></h3>
            <p>Found {{ city_matches|length }} compatible and available donor(s). Please contact them directly.</p>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Phone Number</th>
                        <th>City</th>
                        <th>Email</th>
                        <th>Blood Group</th>
                        <th>Last Donated</th>
                    </tr>
                </thead>
                <tbody>
                    {% for donor in city_matches %}
                    <tr>
                        <td>{{ donor.name }}</td>
                        <td>{{ donor.phone_no }}</td>
                        <td>{{ donor.address }}</td>
                        <td>{{ donor.email }}</td>
                        <td>{{ donor.blood_group }}</td>
                        <td>{{ donor.last_donation_date if donor.last_donation_date else 'N/A' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}

        {% if state_matches %}
            <h3 style="margin-top: 30px;"><span style="color: #555;">Other Matches (in {{ state }})</span></h3>
            <p>Found {{ state_matches|length }} other donor(s) in the same state.</p>
            <table>
                <thead>
                    <tr>
                        <th>Name</th>
                        <th>Phone Number</th>
                        <th>City</th>
                        <th>Email</th>
                        <th>Blood Group</th>
                        <th>Last Donated</th>
                    </tr>
                </thead>
                <tbody>
                    {% for donor in state_matches %}
                    <tr>
                        <td>{{ donor.name }}</td>
                        <td>{{ donor.phone_no }}</td>
                        <td>{{ donor.address }}</td>
                        <td>{{ donor.email }}</td>
                        <td>{{ donor.blood_group }}</td>
                        <td>{{ donor.last_donation_date if donor.last_donation_date else 'N/A' }}</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% endif %}

        {% if not city_matches and not state_matches %}
            <p>Sorry, no active and eligible donors found in {{ state }} for this blood group or its compatible types at the moment.</p>
        {% endif %}
        
        <br>
        <a href="/home" class="button" style="margin-top: 20px;">Back to Home</a>
    </div>
    <footer><p>Made By Team VitalX - DBMS-V-T233</p></footer>
</body>
</html>